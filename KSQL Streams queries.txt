CREATE STREAM users_input (
    email VARCHAR,
    first_name VARCHAR,
    last_name VARCHAR,
    age INT,
    address VARCHAR,
    gender VARCHAR,
    job VARCHAR,
    has_children_under_16 BOOLEAN
  ) WITH (
    KAFKA_TOPIC = 'users',
    VALUE_FORMAT = 'AVRO'
  );

CREATE STREAM users_potentially_interested_in_buying_toys AS
	SELECT     
	email,
    first_name,
    last_name,
    age,
    address,
    gender,
    job,
    has_children_under_16
	from users_input 
	where age >=18
	EMIT CHANGES;


CREATE TABLE users_count_by_gender as
	SELECT 
		gender,
		count(gender) as count,
	FROM users_input
	WINDOW TUMBLING (SIZE 1 MINUTE, GRACE PERIOD 2 HOURS)
	GROUP BY gender
	emit changes;
	
	
CREATE STREAM cars_input (
    name VARCHAR,
    description VARCHAR,
    category VARCHAR,
    barcode VARCHAR,
    price INT
  ) WITH (
    KAFKA_TOPIC = 'products',
    VALUE_FORMAT = 'AVRO'
  );
  
  
 CREATE STREAM cars_suv AS
	SELECT     
	name,
    description,
    category,
    barcode,
    price
	from cars_input 
	where category = 'SUV'
	EMIT CHANGES;
